<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>SPH：入门 | ReubenSun</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="SPH入门 SPH（Smoothed Particle Hydrodynamics）光滑粒子流体力学  A mesh-free method for the discretization of functions and partial differential operators  SPH是一种基于拉格朗日视角的算法，是一种空间离散化的算法，常用于连续介质的数值模拟   材质导数的坐标   拉格">
<meta property="og:type" content="article">
<meta property="og:title" content="SPH：入门">
<meta property="og:url" content="http://reuben-sun.github.io/2023/02/02/graphics/SPH/index.html">
<meta property="og:site_name" content="ReubenSun">
<meta property="og:description" content="SPH入门 SPH（Smoothed Particle Hydrodynamics）光滑粒子流体力学  A mesh-free method for the discretization of functions and partial differential operators  SPH是一种基于拉格朗日视角的算法，是一种空间离散化的算法，常用于连续介质的数值模拟   材质导数的坐标   拉格">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://reuben-sun.github.io/images/%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A5.png">
<meta property="og:image" content="http://reuben-sun.github.io/images/%E9%AB%98%E6%96%AF%E9%92%9F%E5%BD%A2.png">
<meta property="og:image" content="http://reuben-sun.github.io/images/核函数.png">
<meta property="og:image" content="http://reuben-sun.github.io/images/%E6%A0%B8%E5%87%BD%E6%95%B0%E6%80%A7%E8%B4%A8.png">
<meta property="og:image" content="http://reuben-sun.github.io/images/%E4%B8%89%E6%AC%A1%E6%A0%B7%E6%9D%A1%E5%99%A8.png">
<meta property="og:image" content="http://reuben-sun.github.io/images/离散化.png">
<meta property="og:image" content="http://reuben-sun.github.io/images/流体边界.png">
<meta property="og:image" content="http://reuben-sun.github.io/images/grid.png">
<meta property="og:image" content="http://reuben-sun.github.io/images/应力张量.png">
<meta property="og:image" content="http://reuben-sun.github.io/images/柯西应力张量.png">
<meta property="og:image" content="http://reuben-sun.github.io/images/三维应力.png">
<meta property="og:image" content="http://reuben-sun.github.io/images/算子分解.png">
<meta property="og:image" content="http://reuben-sun.github.io/images/%E7%AC%A6%E5%8F%B7.png">
<meta property="article:published_time" content="2023-02-02T22:16:25.000Z">
<meta property="article:modified_time" content="2023-03-01T17:22:20.537Z">
<meta property="article:author" content="Reuben Sun">
<meta property="article:tag" content="SPH">
<meta property="article:tag" content="Physics">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://reuben-sun.github.io/images/%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A5.png">
  
    <link rel="alternate" href="/atom.xml" title="ReubenSun" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.4.2"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">ReubenSun</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://reuben-sun.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-graphics/SPH" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2023/02/02/graphics/SPH/" class="article-date">
  <time datetime="2023-02-02T22:16:25.000Z" itemprop="datePublished">2023-02-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/graphics/">graphics</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      SPH：入门
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1>SPH入门</h1>
<p>SPH（Smoothed Particle Hydrodynamics）光滑粒子流体力学</p>
<blockquote>
<p>A mesh-free method for the discretization of functions and partial differential operators</p>
</blockquote>
<p>SPH是一种基于拉格朗日视角的算法，是一种空间离散化的算法，常用于连续介质的数值模拟</p>
<ul>
<li>
<p>材质导数的坐标</p>
<ul>
<li>
<p>拉格朗日坐标：视角随着介质移动而移动（粒子模拟）</p>
</li>
<li>
<p>欧拉坐标：视角是固定的，检测穿过视角的介质流速（网格模拟）</p>
</li>
</ul>
</li>
</ul>
<p><img src="/images/%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A5.png" alt="拉格朗日"></p>
<p>SPH进行简单流体模拟，简单来说就是</p>
<ol>
<li>介质离散化，使用多个质点来表示流体（离散化）</li>
<li>对于每一个粒子，找到它附近的粒子（临域搜索）</li>
<li>计算密度（质量密度估计）</li>
<li>计算压强（控制方程，如理想气体状态方程+动量守恒），压强差、粘滞力等</li>
<li>更新运动状态</li>
<li>水体渲染（Marching Cube）</li>
</ol>
<h2 id="离散化">离散化</h2>
<h3 id="狄拉克函数">狄拉克函数</h3>
<p>狄拉克$\delta$函数，这是一个广义函数，其在整个定义域中积分值都集中在原点<br>
$$<br>
\delta (\mathbf{r})= \begin{cases}<br>
\infty &amp; |\mathbf{r}|=0 \\<br>
0 &amp; otherwise<br>
\end{cases}<br>
$$<br>
该函数仅在积分中有意义，可以通过高斯钟形函数（正态分布）逼近</p>
<p><img src="/images/%E9%AB%98%E6%96%AF%E9%92%9F%E5%BD%A2.png" alt="高斯钟形"></p>
<p>在物理学中我们常用质点表示物体，但是因此使得密度函数失去了意义（因为质点没有空间），此时密度函数就塌缩成了狄拉克函数</p>
<p>空间中任何标量场函数，都可以用狄拉克函数表示：<br>
$$<br>
A(\mathbf{x})=(A*\delta)(\mathbf{x})=\int A(\mathbf{x}‘)\delta (\mathbf{x}-\mathbf{x}’)dv’<br>
$$</p>
<ul>
<li>$dv’$是$\mathbf{x}'$对应的体积积分变量</li>
<li>$A(\mathbf{x}): \mathbb{R}^d \rightarrow \mathbb{R}$，d是维度，意思就是这是一个空间函数</li>
</ul>
<blockquote>
<p>$\mathbb{R}$是实数集</p>
<p>$\mathbb{R}^+$是正实数集（不含0）</p>
<p>$\mathbb{R}^d$是d维实数集</p>
</blockquote>
<h3 id="光滑核函数">光滑核函数</h3>
<p>我们有了狄拉克函数，想要把连续函数来离散表示</p>
<p>核函数（kernel functions，smoothing kernels）是一种随着距离而衰减的函数，与高斯函数要在整个作用域积分不同，核函数是有最大影响半径的，最大影响半径用$h$表示</p>
<img src="/images/核函数.png" alt="核函数" style="zoom:50%;" />
<p>核函数满足</p>
<ol>
<li>归一化</li>
<li>狄拉克条件</li>
<li>非负性</li>
<li>对称性</li>
<li>有界性</li>
</ol>
<p><img src="/images/%E6%A0%B8%E5%87%BD%E6%95%B0%E6%80%A7%E8%B4%A8.png" alt="核函数性质"></p>
<p>一个经典的核函数是三次样条器（cubic spline kernel）</p>
<p><img src="/images/%E4%B8%89%E6%AC%A1%E6%A0%B7%E6%9D%A1%E5%99%A8.png" alt="三次样条器"></p>
<ul>
<li>其中$q=\frac{1}{h}||\mathbf{r}||$</li>
</ul>
<h3 id="离散化-2">离散化</h3>
<blockquote>
<p>有个数学大佬告诉我，这里就是“在某个i点处求所有其他j点按核函数加权的平均值，只不过离散化的时候划成了区块赋予了密度和体积”</p>
<p>换句话说，这其实就是一次卷积（数学家真是不讲人话）</p>
</blockquote>
<p>参考上面那张核函数的图，离散化就是对于$i$点，我们求该点附近场密度函数值和核函数（一堆$j$点）的加权平均值</p>
<img src="/images/离散化.png" alt="离散化" style="zoom:50%;" />
<p>在数学上，$\langle A(x)\rangle $表示平均值</p>
<h3 id="质量密度估计">质量密度估计</h3>
<p>粒子不需要携带质量密度函数，对于空间中任意位置的点，都可以通过离散化求出该点密度</p>
<p>对于$\mathbf{x}_i$位置处的点，其密度为：</p>
<p>$$<br>
\rho_{i} =\sum_{j} m_{j}W_{ij}<br>
$$<br>
不过在流体边界，这样求密度会导致数据偏小，需要做边界处理</p>
<p>下图绿色点临域完整，得到正确的密度，而红色点只能得到一个较小的密度</p>
<img src="/images/流体边界.png" alt="流体边界" style="zoom:50%;" />
<h3 id="微分算子的离散化">微分算子的离散化</h3>
<p>上面我们已经实现场函数的离散化，实现了质量密度估计。但除此之外，还有一些空间微分算子（导数）值得离散化<br>
$$<br>
\nabla A_{i}\approx \sum_{j} A_{j}\frac{m_{j}}{\rho_{j} } \nabla W_{ij}<br>
$$</p>
<blockquote>
<p>关于拉普拉斯算符，可以去看<a href="/2023/01/31/math/Nabla%E7%AE%97%E5%AD%90/">Nabla算子</a>，简单来说这东西是将标量场转化为向量场，一阶算符就是梯度，二阶是散度，用于得到数据变化最快的方向。文中也实现了拉普拉斯算符的离散化</p>
</blockquote>
<p>文章介绍了两种最常用的梯度的近似方法，并给了适用范围</p>
<ul>
<li>差分公式（Difference Formula）：用于近似速度的散度</li>
<li>对称公式（Symmetric Formula）：用于近似力、脉冲的梯度</li>
</ul>
<h4 id="差分公式">差分公式</h4>
<p>在高中学微积分时，我们用两个相邻的点组成的线来逼近切线，以此引入了极限、导数的概念。在实际应用中，这两个点不可能无穷近，于是存在误差</p>
<p>使用差分表示导数（导数就是），我们只能把$h$取到一个很小的值，而不是无穷小，因此这个导数是有误差的<br>
$$<br>
f’(x)=\lim_{h \rightarrow0}\frac{f(x+h/2)-f(x-h/2)}{h}<br>
$$<br>
我们需要衡量这个误差的大小，于是我们将$f(x\pm h/2)$泰勒展开后带入上式，得到<br>
$$<br>
f’(x)=\lim_{h \rightarrow0}\frac{f’(x)h+O(h^3)}{h}=f’(x)+O(h^2)<br>
$$<br>
误差大小为$O(h^2)$</p>
<blockquote>
<p>经计算，二阶导数的误差也是$O(h^2)$</p>
</blockquote>
<h4 id="对称公式">对称公式</h4>
<h2 id="临域搜索">临域搜索</h2>
<p>这里介绍最简单的，不做空间优化的临域搜索，进阶内容可以看<a href="2023/02/06/graphics/%E9%82%BB%E5%9F%9F%E6%90%9C%E7%B4%A2/">临域搜索</a></p>
<p>由于核函数存在作用范围，我们在积分时，只需要遍历核半径内其他粒子的信息。这样相较于nxn的全遍历，能大幅减少计算，为此我们需要构建临域表</p>
<h3 id="网格化">网格化</h3>
<p>临域搜索是一种基于网格（grid）构建粒子拓扑关系的算法，找到该粒子所在位置和其相邻位置有哪些粒子</p>
<p>我们将整个（粒子作用的）场景均匀切分为一个个三维网格，每个网格为立方体，边长等于核半径$\hslash $，</p>
<p>每个网格拥有一个坐标$(i,j,k)$，用于表示网格在场景中的位置</p>
<p>对于任意一个粒子，其核函数的作用范围是一个球，临域搜索就是计算球内有哪些粒子</p>
<img src="/images/grid.png" alt="grid" style="zoom: 33%;" />
<ol>
<li>空间网格化</li>
<li>遍历粒子，记录每个网格中有多少个粒子，有哪些粒子</li>
<li>遍历粒子，建立临域表
<ol>
<li>求该粒子的核函数球位于哪些网格中</li>
<li>遍历那些网格，取出网格中所有粒子，计算距离</li>
<li>将距离小于核半径的粒子id存储在临域表中</li>
</ol>
</li>
</ol>
<h3 id="数据结构">数据结构</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>_neighbourList</td>
<td>id.x * maximumParticlesPerCell * 8 + _neighbourTracker[id.x]++</td>
<td>临居的id</td>
</tr>
<tr>
<td>_neighbourTracker</td>
<td>id.x</td>
<td>当前粒子有多少个临居</td>
</tr>
<tr>
<td>_hashGrid</td>
<td>hashCellIdx * maximumParticlesPerCell + previousCount</td>
<td>id.x</td>
</tr>
<tr>
<td>_hashGridTracker</td>
<td>hashCellIdx</td>
<td>该网格中的粒子数</td>
</tr>
</tbody>
</table>
<ul>
<li>id.x：当前粒子id</li>
<li>hashCellIdx：网格坐标的Hash值</li>
<li>maximumParticlesPerCell：每个网格的的粒子最大数量（提前留好空）</li>
<li>previousCount：空里有几个粒子</li>
</ul>
<h3 id="球作用于哪些网格">球作用于哪些网格</h3>
<p>我们发现核函数球最少位于8个网格中（一个2x2x2的立方体），最多位于27个网格中（一个3x3x3的立方体），我们只需要找出核函数球位于哪些网格中，就能减少很多便利</p>
<p>在这里，我们只使用8个网格作为临域（舍弃那些不重要的网格），很显然，球心向哪个方向靠，我们就使用哪8个网格</p>
<ol>
<li>找到球心所在网格坐标，构建临域坐标表，临域坐标初始均设为球心位置</li>
<li>判断中心网格的中心坐标与球心的坐标位置关系</li>
<li>存储临域Hash Key</li>
</ol>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">GetNearbyKeys</span><span class="token punctuation">(</span>int3 originIndex<span class="token punctuation">,</span> float3 position<span class="token punctuation">,</span> out <span class="token keyword">int</span> nearbyKeys<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 
<span class="token punctuation">&#123;</span>
    int3 nearbyBucketIndices<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> 
    <span class="token punctuation">&#123;</span>
        nearbyBucketIndices<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> originIndex<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>originIndex<span class="token punctuation">.</span>x <span class="token operator">+</span> <span class="token number">0.5f</span><span class="token punctuation">)</span> <span class="token operator">*</span> CellSize <span class="token operator">&lt;=</span> position<span class="token punctuation">.</span>x<span class="token punctuation">)</span> 
    <span class="token punctuation">&#123;</span>        
        nearbyBucketIndices<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        nearbyBucketIndices<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        nearbyBucketIndices<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        nearbyBucketIndices<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">&#123;</span>
        nearbyBucketIndices<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        nearbyBucketIndices<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        nearbyBucketIndices<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        nearbyBucketIndices<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>originIndex<span class="token punctuation">.</span>y <span class="token operator">+</span> <span class="token number">0.5f</span><span class="token punctuation">)</span> <span class="token operator">*</span> CellSize <span class="token operator">&lt;=</span> position<span class="token punctuation">.</span>y<span class="token punctuation">)</span> 
    <span class="token punctuation">&#123;</span>
        nearbyBucketIndices<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        nearbyBucketIndices<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        nearbyBucketIndices<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        nearbyBucketIndices<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">&#123;</span>
        nearbyBucketIndices<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        nearbyBucketIndices<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        nearbyBucketIndices<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        nearbyBucketIndices<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>originIndex<span class="token punctuation">.</span>z <span class="token operator">+</span> <span class="token number">0.5f</span><span class="token punctuation">)</span> <span class="token operator">*</span> CellSize <span class="token operator">&lt;=</span> position<span class="token punctuation">.</span>z<span class="token punctuation">)</span> 
    <span class="token punctuation">&#123;</span>
        nearbyBucketIndices<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>z <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        nearbyBucketIndices<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>z <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        nearbyBucketIndices<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">.</span>z <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        nearbyBucketIndices<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">.</span>z <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">&#123;</span>
        nearbyBucketIndices<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>z <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        nearbyBucketIndices<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>z <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        nearbyBucketIndices<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">.</span>z <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        nearbyBucketIndices<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">.</span>z <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> 
    <span class="token punctuation">&#123;</span>
        int3 nbcellIndex <span class="token operator">=</span> nearbyBucketIndices<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>nbcellIndex<span class="token punctuation">.</span>x <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> nbcellIndex<span class="token punctuation">.</span>x <span class="token operator">>=</span> Dimensions <span class="token operator">||</span> nbcellIndex<span class="token punctuation">.</span>y <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> nbcellIndex<span class="token punctuation">.</span>y <span class="token operator">>=</span> Dimensions <span class="token operator">||</span> nbcellIndex<span class="token punctuation">.</span>z <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> nbcellIndex<span class="token punctuation">.</span>z <span class="token operator">>=</span> Dimensions<span class="token punctuation">)</span> 
        <span class="token punctuation">&#123;</span>
            nearbyKeys<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>		<span class="token comment">//出界了</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span> 
        <span class="token punctuation">&#123;</span>
            nearbyKeys<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">Hash</span><span class="token punctuation">(</span>nearbyBucketIndices<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">//将三维坐标转化为一维hash key</span>
<span class="token keyword">int</span> <span class="token function">Hash</span><span class="token punctuation">(</span>int3 cell<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> cell<span class="token punctuation">.</span>x <span class="token operator">+</span> Dimensions <span class="token operator">*</span> <span class="token punctuation">(</span>cell<span class="token punctuation">.</span>y <span class="token operator">+</span> Dimensions <span class="token operator">*</span> cell<span class="token punctuation">.</span>z<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code></pre>
<h3 id="构建临域表">构建临域表</h3>
<pre class="language-cpp" data-language="cpp"><code class="language-cpp"><span class="token punctuation">[</span><span class="token function">numthreads</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">void</span> <span class="token function">BuildNeighbourList</span><span class="token punctuation">(</span>uint3 id <span class="token operator">:</span> SV_DispatchThreadID<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    _neighbourTracker<span class="token punctuation">[</span>id<span class="token punctuation">.</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> int3 cell <span class="token operator">=</span> <span class="token function">GetCell</span><span class="token punctuation">(</span>_particles<span class="token punctuation">[</span>id<span class="token punctuation">.</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span>position<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> cells<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">GetNearbyKeys</span><span class="token punctuation">(</span>cell<span class="token punctuation">,</span> _particles<span class="token punctuation">[</span>id<span class="token punctuation">.</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span>position<span class="token punctuation">,</span> cells<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>uint j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>cells<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span> <span class="token comment">// Grid does not contain cell.</span>
        <span class="token keyword">const</span> uint numberOfParticlesInCell <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>_hashGridTracker<span class="token punctuation">[</span>cells<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> maximumParticlesPerCell<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>uint index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> numberOfParticlesInCell<span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">const</span> uint potentialNeighbour <span class="token operator">=</span> _hashGrid<span class="token punctuation">[</span>cells<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> maximumParticlesPerCell <span class="token operator">+</span> index<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>potentialNeighbour <span class="token operator">==</span> id<span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token keyword">const</span> float3 v <span class="token operator">=</span> _particles<span class="token punctuation">[</span>potentialNeighbour<span class="token punctuation">]</span><span class="token punctuation">.</span>position <span class="token operator">-</span> _particles<span class="token punctuation">[</span>id<span class="token punctuation">.</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span>position<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">dot</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> v<span class="token punctuation">)</span> <span class="token operator">&lt;</span> radius2<span class="token punctuation">)</span> <span class="token comment">// Use squared length (= dot) instead of length for performance.</span>
            <span class="token punctuation">&#123;</span>
                _neighbourList<span class="token punctuation">[</span>id<span class="token punctuation">.</span>x <span class="token operator">*</span> maximumParticlesPerCell <span class="token operator">*</span> <span class="token number">8</span> <span class="token operator">+</span> _neighbourTracker<span class="token punctuation">[</span>id<span class="token punctuation">.</span>x<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> potentialNeighbour<span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code></pre>
<h2 id="控制方程">控制方程</h2>
<p>尽管物体在微观层面（比如原子）是离散的，但在宏观层面上，流体、固体表现为连续介质</p>
<blockquote>
<p>continuum, a region of continuously distributed mass</p>
</blockquote>
<p>根据定义，一个连续介质可以被切分为多个小的连续介质（类比实数的稠密性，任意两个实数间总存在第三个实数），而不影响其性质</p>
<p>材料粒子（material particle）：a portion of matter contained in an infinitesimal volume</p>
<h3 id="连续性方程">连续性方程</h3>
<p>连续性方程描述了物体的密度与时间的关系<br>
$$<br>
\frac{D\rho}{Dt}=-\rho(\nabla \cdot \mathbf{v})<br>
$$</p>
<h3 id="随体导数">随体导数</h3>
<p>随体导数（material derivative）：$\frac{D(\cdot)}{Dt}$</p>
<p>随体导数描述了材质点的场量随着时间的变化率</p>
<p>在制作不可压缩的介质中，必须始终保持<br>
$$<br>
\frac{D\rho}{Dt}=0<br>
$$<br>
随体导数与坐标系有关，常见的坐标系有：拉格朗日坐标系和欧拉坐标系</p>
<h3 id="线性动量守恒定律">线性动量守恒定律</h3>
<p>高中物理就学过的碰撞时动量守恒，力作用在物体上，会改变物体的动量</p>
<p>将运动公式（equation of motion）用积分的形式写出来就是<br>
$$<br>
\rho \frac{D^2\mathbf{x}}{Dt^2}=\nabla \cdot \mathbf{T}+\mathbf{f}_{ext}<br>
$$</p>
<ul>
<li>$\mathbf{T}$：应力张量（stress tensor）</li>
<li>$\mathbf{f}_{ext}$：体积力（body forces），穿越空间作用在所有流体元上的非接触力，例如重力、惯性力、电磁力</li>
</ul>
<h4 id="理解应力张量">理解应力张量</h4>
<p>对于材质内部一个微小平面，这个平面会受材质中其他点的作用力，这个力可能不与平面垂直。其中垂直于平面的力叫正向应力，平行于平面的力叫剪应力</p>
<p>矢量是一种一维张量，由大小和一个方向组成。然而对于应力，我们没法使用矢量进行表示，于是改用二维张量来表示，一个方向是应力的指向，一个方向是应力所在的平面方向</p>
<p>对于材质内一个点，它可能处于无数个平面中，我们需要用一种平面无关的方式来表示其受力状态。在三维空间中，我们选择了三组正交基底$(\mathbf{e}_1,\mathbf{e}_2,\mathbf{e}_3)$构建坐标系，应用中给定一个方向$\mathbf{e}$，就能求出该方向的应力矢量</p>
<img src="/images/应力张量.png" alt="应力张量" style="zoom:50%;" />
<p>其中$\mathbf{T}$为应力矢量，$\sigma $为柯西应力张量（一个3x3的矩阵）</p>
<p>$\sigma_{xy}$的意思是，处于yz平面，指向y方向</p>
<img src="/images/柯西应力张量.png" alt="柯西应力张量" style="zoom:50%;" />
<img src="/images/三维应力.png" alt="三维应力" style="zoom:50%;" />
<blockquote>
<p>柯西应力张量只适用于材料微小变形的情况</p>
</blockquote>
<h4 id="Navier-Stokes方程">Navier-Stokes方程</h4>
<p>一个经典的不可压缩流体的张力表示方法<br>
$$<br>
\mathbf{T}=-p+\mu (\nabla \mathbf{v}+\nabla  \mathbf{v}^T)<br>
$$</p>
<ul>
<li>$p$：压强</li>
<li>$\mu$：粘度（viscosity ）</li>
</ul>
<p>我们将该液体的应力张量公式带入牛顿运动公式，得到速度的公式<br>
$$<br>
\rho \frac{D\mathbf{v}}{Dt}=-\nabla p + \mu \nabla^2 \mathbf{v}+\mathbf{f}_{ext}<br>
$$<br>
压强可以由密度表示，根据理想气体压强公式，我们得知压强与密度呈线性关系，于是我们取一个静止状态下的密度$\rho_0$，通过与当前状态密度做差值，就能得出压强</p>
<blockquote>
<p>理想气体压强公式，初中就学了，$pV=nRT$</p>
</blockquote>
<p>$$<br>
p=B((\frac{\rho}{\rho_0})^{\gamma}-1)<br>
$$</p>
<ul>
<li>$B$：体积模量（bulk modulus）</li>
</ul>
<h4 id="弹力">弹力</h4>
<p>拥有弹力的固体，应力张量来自于固体的形变，之后会展开讲</p>
<h2 id="积分求解">积分求解</h2>
<h3 id="混合初始边界值问题">混合初始边界值问题</h3>
<p>我们上面给出了控制方程，但是想要求解运动问题，必须给定初始位置和速度（场）</p>
<p>一般而言，混合初始边界值问题（Mixed Initial-Boundary Value Problem）没有解析解，只有数值解</p>
<blockquote>
<p>得嘞，这一节就这一句话，这一句话一个字都看不懂</p>
</blockquote>
<h4 id="混合边界">混合边界</h4>
<blockquote>
<p>简单来说，就是要想求解运动问题，必须既要给初始位置，也要给初始速度（场）</p>
</blockquote>
<p>边界条件也叫定解条件，是微分方程里的概念，给定初始值才能求控制方程、偏微分方程的解（比如带入解中的未知数）</p>
<p>放在物理学中叫临界条件，就是物体处于某两种状态间的交界处，比如冰水混合物</p>
<p>边界条件对于解决物理问题（比如求极值）十分重要</p>
<p>有三类边界条件</p>
<ul>
<li>第一类边界条件（迪利克雷边界条件，Dirichlet boundary condition）
<ul>
<li>直接告诉你边界值，比如热传递中告诉你边界处温度</li>
</ul>
</li>
<li>第二类边界（若依曼边界条件，Neumann boundary condition）
<ul>
<li>告诉你边界处的梯度，比如热传递中告诉你热流密度（温度的梯度）</li>
</ul>
</li>
<li>混合边界条件
<ul>
<li>第一二类边界的混合，比如热对流微分公式，公式中既有温度，也有梯度，只有同时给出两者，才能求解</li>
</ul>
</li>
</ul>
<p>$$<br>
q=h(T_0-T_a)<br>
$$</p>
<h4 id="解析解与数值解">解析解与数值解</h4>
<ul>
<li>解析解（analytic solution），形如一个函数，给定变量就能得出任意位置的解</li>
<li>数值解（numerical solution），这是一个数，是采用有限元、数值逼近、插值等方法得到的解</li>
</ul>
<blockquote>
<p>据说在数学家和物理学家眼里，解析解才是真正的解，更高贵，美丽</p>
<p>让我突然想到三体力魏成想要求出三体问题的解析解，结果最后发现这个问题只有数值解</p>
</blockquote>
<h3 id="算子分裂">算子分裂</h3>
<p>就是使用分治的算法，将一个复杂的偏微分方程（PDE），分解为几个连续的子问题</p>
<img src="/images/算子分解.png" alt="算子分解"  />
<p>在实践中证明，像这样每步操作依赖于上一步，一步一步操作，能提高系统的稳定性</p>
<h3 id="时间积分">时间积分</h3>
<p>在实时渲染中，和精度相比，性能、稳定性和鲁棒性更重要</p>
<p>在GAMES201开篇讲弹簧质点模型时，关于质点的运动方程，给出了两种积分器：显式积分器和隐式积分器</p>
<h4 id="显式积分器">显式积分器</h4>
<p>从过去的状态得到现在的状态，表示简单容易实现</p>
<p>$$<br>
\mathbf{v}_{t+1}=\mathbf{v}_t+\Delta t \frac{\mathbf{f}_t}{m}<br>
$$</p>
<!---->
<p>$$<br>
\mathbf{x}_{t+1}=\mathbf{x}<em>t+\Delta t \mathbf{v}</em>{t+1}<br>
$$</p>
<p>但是显式积分器有一个问题，就是容易爆炸，于是$\Delta t$不能太大，应满足<br>
$$<br>
\Delta t \le c\sqrt{\frac{m}{k}} \ \ (c \sim 1)<br>
$$</p>
<h5 id="CFL条件">CFL条件</h5>
<p>这是CFL条件（Courant–Friedrichs–Lewy condition），是某些偏微分方程的收敛条件，它决定了显式积分器中粒子在单位时间内走过的距离，必须小于粒子大小（或者说质点间的间距）<br>
$$<br>
\Delta t \le \lambda \frac{\tilde{h}}{|\mathbf{v}^{\max}|}<br>
$$</p>
<ul>
<li>$\tilde{h}$：粒子大小（质点间的间距）</li>
<li>$\lambda$：一个常量</li>
<li>$\mathbf{v}^{\max}$：粒子运动的最快速度</li>
</ul>
<h4 id="隐式积分器">隐式积分器</h4>
<p>现在的状态依赖于现在的状态（求$t+1$时刻的信息，结果需要$t+1$时刻的信息），难以实现，但鲁棒性强</p>
<!---->
<p>$$<br>
\mathbf{v}_{t+1}=\mathbf{v}<em>t+\Delta t \mathbf{M}^{-1}\mathbf{f}(\mathbf{x}</em>{t+1})<br>
$$</p>
<!---->
<p>$$<br>
\mathbf{x}_{t+1}=\mathbf{x}<em>t+\Delta t \mathbf{v}</em>{t+1}<br>
$$</p>
<ul>
<li>$\mathbf{M}$：质量矩阵</li>
</ul>
<h2 id="Marching-Cube">Marching Cube</h2>
<h2 id="符号表">符号表</h2>
<p><img src="/images/%E7%AC%A6%E5%8F%B7.png" alt="符号"></p>
<h2 id="参考">参考</h2>
<p><a target="_blank" rel="noopener" href="https://interactivecomputergraphics.github.io/physics-simulation/">Physics Simulation in Visual Computing</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1ZK411H7Hc">GAMES201</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/426566636">MrKill的知乎</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/alen-cell/PhysicsEngine">alen-cell</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://reuben-sun.github.io/2023/02/02/graphics/SPH/" data-id="clepy40o4000dglnk8lv2ap4b" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Physics/" rel="tag">Physics</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SPH/" rel="tag">SPH</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2023/02/06/graphics/%E9%82%BB%E5%9F%9F%E6%90%9C%E7%B4%A2/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          SPH：邻域搜索
        
      </div>
    </a>
  
  
    <a href="/2023/02/02/%E6%88%91%E6%98%AF%E8%B0%81/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">我是谁</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/dcc/">dcc</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/engine/">engine</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/graphics/">graphics</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/math/">math</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/optics/">optics</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/program/">program</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/" rel="tag">C#</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/" rel="tag">C++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CMake/" rel="tag">CMake</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DX12/" rel="tag">DX12</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Deferred-Render/" rel="tag">Deferred Render</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GC/" rel="tag">GC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GI/" rel="tag">GI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Metal/" rel="tag">Metal</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PM/" rel="tag">PM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Physics/" rel="tag">Physics</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/" rel="tag">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SIGGRAPH/" rel="tag">SIGGRAPH</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SPH/" rel="tag">SPH</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TA/" rel="tag">TA</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Unity/" rel="tag">Unity</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Unreal/" rel="tag">Unreal</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Windows/" rel="tag">Windows</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shader/" rel="tag">shader</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%85%89%E5%AD%A6/" rel="tag">光学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B9%B6%E8%A1%8C%E8%AE%A1%E7%AE%97/" rel="tag">并行计算</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BE%AE%E7%A7%AF%E5%88%86/" rel="tag">微积分</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/" rel="tag">高等数学</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/C/" style="font-size: 10px;">C#</a> <a href="/tags/C/" style="font-size: 17.5px;">C++</a> <a href="/tags/CMake/" style="font-size: 10px;">CMake</a> <a href="/tags/DX12/" style="font-size: 10px;">DX12</a> <a href="/tags/Deferred-Render/" style="font-size: 10px;">Deferred Render</a> <a href="/tags/GC/" style="font-size: 10px;">GC</a> <a href="/tags/GI/" style="font-size: 15px;">GI</a> <a href="/tags/Linux/" style="font-size: 10px;">Linux</a> <a href="/tags/Metal/" style="font-size: 10px;">Metal</a> <a href="/tags/PM/" style="font-size: 10px;">PM</a> <a href="/tags/Physics/" style="font-size: 12.5px;">Physics</a> <a href="/tags/Python/" style="font-size: 10px;">Python</a> <a href="/tags/SIGGRAPH/" style="font-size: 15px;">SIGGRAPH</a> <a href="/tags/SPH/" style="font-size: 12.5px;">SPH</a> <a href="/tags/TA/" style="font-size: 15px;">TA</a> <a href="/tags/Unity/" style="font-size: 12.5px;">Unity</a> <a href="/tags/Unreal/" style="font-size: 10px;">Unreal</a> <a href="/tags/Windows/" style="font-size: 10px;">Windows</a> <a href="/tags/shader/" style="font-size: 10px;">shader</a> <a href="/tags/%E5%85%89%E5%AD%A6/" style="font-size: 20px;">光学</a> <a href="/tags/%E5%B9%B6%E8%A1%8C%E8%AE%A1%E7%AE%97/" style="font-size: 10px;">并行计算</a> <a href="/tags/%E5%BE%AE%E7%A7%AF%E5%88%86/" style="font-size: 10px;">微积分</a> <a href="/tags/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/" style="font-size: 17.5px;">高等数学</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">二月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">一月 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/02/26/optics/%E5%85%89%E5%AD%A6%E5%A4%8D%E4%B9%A0/">光学复习</a>
          </li>
        
          <li>
            <a href="/2023/02/25/optics/%E8%A1%8D%E5%B0%84/">衍射</a>
          </li>
        
          <li>
            <a href="/2023/02/25/optics/%E5%B9%B2%E6%B6%89/">干涉</a>
          </li>
        
          <li>
            <a href="/2023/02/18/program/AskQuestion/">提问的智慧</a>
          </li>
        
          <li>
            <a href="/2023/02/13/graphics/DOSDF/">Dynamic Occlusion with SDF</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2023 Reuben Sun<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>